---
// src/components/FAQItem.astro
interface Props {
  title: string;
  answer: string;
}

const { title, answer } = Astro.props;
// Generamos un ID aleatorio para que cada pregunta sea única
const id = 'faq-' + Math.random().toString(36).substr(2, 9);
---

<div class="faq-container border-b border-slate-100 last:border-0">
  
  <button 
    id={`btn-${id}`}
    class="w-full py-6 flex justify-between items-center text-left group focus:outline-none"
    aria-expanded="false"
    aria-controls={`content-${id}`}
  >
    <span class="text-lg font-bold text-slate-900 group-hover:text-violet-700 transition-colors pr-8">
      {title}
    </span>
    
    <span id={`icon-${id}`} class="shrink-0 w-8 h-8 flex items-center justify-center rounded-full bg-violet-50 text-violet-600 transition-transform duration-300 group-hover:bg-violet-100">
      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg>
    </span>
  </button>

  <div 
    id={`content-${id}`}
    class="overflow-hidden max-h-0 transition-all duration-500 ease-in-out"
  >
    <div class="pb-6 text-slate-600 text-sm leading-relaxed">
      {answer}
    </div>
  </div>

</div>

<script define:vars={{ id }}>
  const btn = document.getElementById(`btn-${id}`);
  const content = document.getElementById(`content-${id}`);
  const icon = document.getElementById(`icon-${id}`);

  if (btn && content && icon) {
    btn.addEventListener('click', () => {
      // Verificamos si está abierto revisando si tiene max-height
      const isOpen = content.style.maxHeight;

      if (isOpen) {
        // CERRAR
        content.style.maxHeight = null; // Vuelve a la clase max-h-0 del CSS
        icon.style.transform = 'rotate(0deg)';
        icon.classList.remove('bg-violet-600', 'text-white'); // Volver estilo normal
        icon.classList.add('bg-violet-50', 'text-violet-600');
      } else {
        // ABRIR (Calculamos la altura real del contenido)
        content.style.maxHeight = content.scrollHeight + "px";
        icon.style.transform = 'rotate(45deg)'; // Se convierte en X
        icon.classList.remove('bg-violet-50', 'text-violet-600');
        icon.classList.add('bg-violet-600', 'text-white'); // Estilo activo
      }
    });
  }
</script>